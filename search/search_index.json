{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#netbox-notices","title":"NetBox Notices","text":"<p>Repository: github.com/jsenecal/netbox-notices Documentation: jsenecal.github.io/netbox-notices PyPI: pypi.org/project/netbox-notices</p> <p>Original Project: Forked and inspired from jasonyates/netbox-circuitmaintenance, differs in the ability to track more than just maintenances, and circuits.</p> <p>A NetBox plugin built to track maintenance and outage events across various NetBox models. This plugin is agnostic in that it is only built to store data surrounding maintenance/outage events and provide an overview of historical, active and upcoming events. The plugin tracks events at the provider level and associates impact across multiple NetBox object types (circuits, devices, virtual machines, power feeds, sites, etc.).</p> <p>The plugin does not directly provide an automated approach to ingesting provider notifications, instead it extends NetBox's extensive REST API and provides GET/POST/PUT/PATCH methods to manage events. The plugin is intended to be coupled with an automated parser to handle the parsing of provider notifications and the delivery of the events to the plugin's REST API. Several example parsers are documented here.</p> <p>Important Note: This is a significant refactoring from the original <code>netbox-circuitmaintenance</code> plugin. There is no upgrade path from the original plugin. If you are using the original plugin, you will need to migrate your data manually.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Track provider maintenance events</li> <li>Track impact from provider maintenance across multiple NetBox object types</li> <li>Configurable allowed object types (circuits, devices, virtual machines, power feeds, sites, etc.)</li> <li>Provides a consolidated view of active, upcoming and historical maintenance events at the provider and object level</li> <li>Track unplanned outage events with optional end times and ETR tracking</li> <li>Unified event notification tracking</li> <li>Quick action buttons for common maintenance operations:</li> <li>Acknowledge maintenance events</li> <li>Reschedule maintenance (only before start time)</li> <li>Mark maintenance as in-progress or completed</li> <li>Cancel maintenance with confirmation</li> <li>Event timeline with status-specific icons and colors</li> <li>Maintenance rescheduling with automatic status updates</li> <li>iCalendar feed for external calendar integration</li> <li>Maintenance overlap detection (coming soon)</li> </ul>"},{"location":"#compatibility","title":"Compatibility","text":"<p>This plugin requires NetBox 4.4.1 or higher.</p> NetBox Version Plugin Version 4.4.1+ 0.2.x"},{"location":"#installing","title":"Installing","text":"<p>A working installation of Netbox 4.4.1+ is required - see official documentation.</p>"},{"location":"#package-installation","title":"Package Installation","text":"<p>Activate your virtual env and install via pip:</p> <pre><code>$ source /opt/netbox/venv/bin/activate\n(venv) $ pip install netbox-notices\n</code></pre> <p>To ensure the plugin is automatically re-installed during future upgrades, add the package to your <code>local_requirements.txt</code>:</p> <pre><code># echo netbox-notices &gt;&gt; local_requirements.txt\n</code></pre>"},{"location":"#enable-the-plugin","title":"Enable the Plugin","text":"<p>In the Netbox <code>configuration.py</code> configuration file add or update the PLUGINS parameter, adding <code>vendor_notification</code>:</p> <pre><code>PLUGINS = [\n    'notices'\n]\n\nPLUGINS_CONFIG = {\n    \"notices\": {},\n}\n</code></pre>"},{"location":"#configuration","title":"Configuration","text":"<p>The plugin supports configuration of which NetBox object types can be linked to maintenance and outage events. By default, the plugin allows linking to circuits, power feeds, and sites.</p>"},{"location":"#default-configuration","title":"Default Configuration","text":"<p>If you don't specify any configuration, the plugin uses these defaults:</p> <pre><code>PLUGINS_CONFIG = {\n    \"notices\": {\n        \"allowed_content_types\": [\n            \"circuits.Circuit\",\n            \"dcim.PowerFeed\",\n            \"dcim.Site\",\n        ]\n    }\n}\n</code></pre>"},{"location":"#custom-configuration","title":"Custom Configuration","text":"<p>You can customize which object types are allowed by specifying the <code>allowed_content_types</code> setting. Content types are specified in the format <code>app_label.model_name</code>.</p>"},{"location":"#example-add-devices-and-virtual-machines","title":"Example: Add Devices and Virtual Machines","text":"<pre><code>PLUGINS_CONFIG = {\n    \"notices\": {\n        \"allowed_content_types\": [\n            \"circuits.Circuit\",\n            \"dcim.Device\",\n            \"dcim.PowerFeed\",\n            \"dcim.Site\",\n            \"virtualization.VirtualMachine\",\n        ]\n    }\n}\n</code></pre>"},{"location":"#example-minimal-configuration-circuits-only","title":"Example: Minimal Configuration (Circuits Only)","text":"<pre><code>PLUGINS_CONFIG = {\n    \"notices\": {\n        \"allowed_content_types\": [\n            \"circuits.Circuit\",\n        ]\n    }\n}\n</code></pre>"},{"location":"#example-extended-configuration","title":"Example: Extended Configuration","text":"<pre><code>PLUGINS_CONFIG = {\n    \"notices\": {\n        \"allowed_content_types\": [\n            \"circuits.Circuit\",\n            \"dcim.Device\",\n            \"dcim.Interface\",\n            \"dcim.PowerFeed\",\n            \"dcim.Rack\",\n            \"dcim.Site\",\n            \"ipam.IPAddress\",\n            \"ipam.Prefix\",\n            \"virtualization.VirtualMachine\",\n            \"virtualization.VMInterface\",\n        ]\n    }\n}\n</code></pre>"},{"location":"#how-configuration-affects-behavior","title":"How Configuration Affects Behavior","text":"<ul> <li>Only object types listed in <code>allowed_content_types</code> will appear in the Impact creation forms</li> <li>The API will reject attempts to create impacts for non-allowed object types</li> <li>Changing the configuration requires a NetBox restart</li> <li>This setting controls which objects can be linked via the <code>Impact</code> model to maintenance and outage events</li> </ul>"},{"location":"#common-netbox-object-types","title":"Common NetBox Object Types","text":"Content Type Description <code>circuits.Circuit</code> Network circuits <code>circuits.Provider</code> Service providers <code>dcim.Device</code> Physical network devices <code>dcim.Interface</code> Device network interfaces <code>dcim.PowerFeed</code> Power supply connections <code>dcim.PowerPanel</code> Power distribution panels <code>dcim.Rack</code> Equipment racks <code>dcim.Site</code> Physical locations <code>ipam.IPAddress</code> IP addresses <code>ipam.Prefix</code> IP prefixes/subnets <code>virtualization.VirtualMachine</code> Virtual machines <code>virtualization.VMInterface</code> VM network interfaces"},{"location":"#apply-database-migrations","title":"Apply Database Migrations","text":"<p>Apply database migrations with Netbox <code>manage.py</code>:</p> <pre><code>(venv) $ python manage.py migrate\n</code></pre>"},{"location":"#restart-netbox","title":"Restart Netbox","text":"<p>Restart the Netbox service to apply changes:</p> <pre><code>sudo systemctl restart netbox\n</code></pre>"},{"location":"#outage-tracking","title":"Outage Tracking","text":"<p>In addition to planned maintenance, this plugin supports tracking unplanned outage events:</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Optional End Time: Outages can be created without an end time, which becomes required when marking as resolved</li> <li>ETR Tracking: Track Estimated Time to Repair with full revision history via NetBox's changelog</li> <li>Outage Status Workflow:</li> <li>REPORTED: Initial state when outage is reported</li> <li>INVESTIGATING: Team is investigating root cause</li> <li>IDENTIFIED: Root cause identified, working on fix</li> <li>MONITORING: Fix applied, monitoring for stability</li> <li>RESOLVED: Outage fully resolved (requires end time)</li> <li>Shared Impact Model: Uses the same impact tracking as maintenance events (Impact model)</li> <li>Unified View: View both maintenance and outages together in a single interface</li> <li>Flexible Object Support: Link outages to any configured NetBox object type</li> </ul>"},{"location":"#api-endpoints","title":"API Endpoints","text":"<p>Maintenance Events:</p> <pre><code>GET    /api/plugins/notices/maintenance/\nPOST   /api/plugins/notices/maintenance/\nGET    /api/plugins/notices/maintenance/{id}/\nPATCH  /api/plugins/notices/maintenance/{id}/\nDELETE /api/plugins/notices/maintenance/{id}/\n</code></pre> <p>Outage Events:</p> <pre><code>GET    /api/plugins/notices/outage/\nPOST   /api/plugins/notices/outage/\nGET    /api/plugins/notices/outage/{id}/\nPATCH  /api/plugins/notices/outage/{id}/\nDELETE /api/plugins/notices/outage/{id}/\n</code></pre> <p>Impact Tracking:</p> <pre><code>GET    /api/plugins/notices/impact/\nPOST   /api/plugins/notices/impact/\nGET    /api/plugins/notices/impact/{id}/\nPATCH  /api/plugins/notices/impact/{id}/\nDELETE /api/plugins/notices/impact/{id}/\n</code></pre>"},{"location":"#example-creating-an-outage","title":"Example: Creating an Outage","text":"<pre><code>POST /api/plugins/notices/outage/\n{\n    \"name\": \"OUT-2024-001\",\n    \"summary\": \"Fiber cut on Main Street\",\n    \"provider\": 1,\n    \"start\": \"2024-10-29T14:30:00Z\",\n    \"estimated_time_to_repair\": \"2024-10-29T18:00:00Z\",\n    \"status\": \"INVESTIGATING\"\n}\n</code></pre>"},{"location":"#example-creating-impact-for-a-circuit","title":"Example: Creating Impact for a Circuit","text":"<pre><code>POST /api/plugins/notices/impact/\n{\n    \"maintenance\": 1,\n    \"content_type\": \"circuits.circuit\",\n    \"object_id\": 42,\n    \"impact\": \"OUTAGE\"\n}\n</code></pre>"},{"location":"#example-creating-impact-for-a-device","title":"Example: Creating Impact for a Device","text":"<pre><code>POST /api/plugins/notices/impact/\n{\n    \"outage\": 1,\n    \"content_type\": \"dcim.device\",\n    \"object_id\": 123,\n    \"impact\": \"DEGRADED\"\n}\n</code></pre>"},{"location":"#data-models","title":"Data Models","text":"<p>The plugin uses four main models to track maintenance and outage events:</p>"},{"location":"#maintenance","title":"Maintenance","text":"<p>Represents a planned maintenance event from a provider. Key fields:</p> <ul> <li><code>name</code>: Event identifier</li> <li><code>summary</code>: Description of the maintenance</li> <li><code>provider</code>: Foreign key to NetBox Provider</li> <li><code>start</code>, <code>end</code>: Maintenance window times</li> <li><code>status</code>: TENTATIVE, CONFIRMED, CANCELLED, IN-PROCESS, COMPLETED, RE-SCHEDULED, UNKNOWN</li> <li><code>internal_ticket</code>: Your organization's tracking ticket reference</li> <li><code>acknowledged</code>: Whether the event has been acknowledged</li> </ul>"},{"location":"#outage","title":"Outage","text":"<p>Represents an unplanned outage event from a provider. Key fields:</p> <ul> <li><code>name</code>: Event identifier</li> <li><code>summary</code>: Description of the outage</li> <li><code>provider</code>: Foreign key to NetBox Provider</li> <li><code>start</code>, <code>end</code>: Outage window times (end is optional until resolved)</li> <li><code>status</code>: REPORTED, INVESTIGATING, IDENTIFIED, MONITORING, RESOLVED</li> <li><code>estimated_time_to_repair</code>: ETR timestamp (tracked with changelog history)</li> <li><code>internal_ticket</code>: Your organization's tracking ticket reference</li> <li><code>acknowledged</code>: Whether the event has been acknowledged</li> </ul>"},{"location":"#impact","title":"Impact","text":"<p>Links maintenance or outage events to affected NetBox objects using Django's Generic Foreign Key pattern:</p> <ul> <li><code>maintenance</code> or <code>outage</code>: Foreign key to the event (mutually exclusive)</li> <li><code>content_type</code>: The type of affected object (e.g., \"circuits.circuit\", \"dcim.device\")</li> <li><code>object_id</code>: The ID of the affected object</li> <li><code>impact</code>: Impact level - NO-IMPACT, REDUCED-REDUNDANCY, DEGRADED, OUTAGE</li> </ul> <p>The Impact model allows linking events to any NetBox object type configured in <code>allowed_content_types</code>.</p>"},{"location":"#eventnotification","title":"EventNotification","text":"<p>Stores raw email notifications received from providers:</p> <ul> <li><code>maintenance</code> or <code>outage</code>: Foreign key to the associated event</li> <li><code>email</code>: Binary email data</li> <li><code>email_body</code>: Extracted body text</li> <li><code>subject</code>: Email subject line</li> <li><code>email_from</code>: Sender address</li> <li><code>email_received</code>: Receipt timestamp</li> </ul>"},{"location":"#screenshots","title":"Screenshots","text":""},{"location":"#credits","title":"Credits","text":"<p>Forked from jasonyates/netbox-circuitmaintenance with significant enhancements including multi-object type support and outage tracking.</p> <p>Based on the NetBox plugin tutorial:</p> <ul> <li>demo repository</li> <li>tutorial</li> </ul> <p>This package was created with Cookiecutter and the <code>netbox-community/cookiecutter-netbox-plugin</code> project template.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#changelog","title":"Changelog","text":""},{"location":"changelog/#010-2025-11-18","title":"0.1.0 (2025-11-18)","text":"<p>BREAKING CHANGE: Complete refactor from netbox-circuitmaintenance to netbox-notices</p> <p>This is the initial release of the fully refactored plugin, now supporting both maintenance and outage tracking across multiple NetBox object types.</p>"},{"location":"changelog/#new-features","title":"New Features","text":"<ul> <li>Outage Tracking: New Outage model for unplanned outages with automatic timestamps</li> <li>Generic Impact Tracking: Associate impacts with any NetBox object (circuits, devices, VMs, etc.)</li> <li>Reschedule Functionality: Reschedule maintenance events with automatic status updates</li> <li>Timeline View: Visual timeline of all changes and events</li> <li>Choice Constants: All ChoiceSet classes now define constants (STATUS_, IMPACT_)</li> <li>Impact Field: Added impact text field to BaseEvent for describing event impact</li> <li>Reported At: Outage model includes reported_at timestamp with timezone conversion</li> <li>Timezone Support: Automatic timezone conversion and display for all timestamp fields</li> <li>Changelog Tracking: Proper changelog tracking for reschedule operations and related objects</li> <li>PyPI Publishing: Automated GitHub Actions workflow for PyPI releases</li> </ul>"},{"location":"changelog/#api-changes","title":"API Changes","text":"<ul> <li>REST API support for Maintenance and Outage models</li> <li>API serializers include all new fields (impact, reported_at, replaces)</li> </ul>"},{"location":"changelog/#infrastructure","title":"Infrastructure","text":"<ul> <li>NetBox 4.4.1+ compatibility</li> <li>Python 3.10+ required</li> <li>Automated CI/CD with GitHub Actions</li> <li>MkDocs documentation with GitHub Pages deployment</li> </ul>"},{"location":"changelog/#migration-notes","title":"Migration Notes","text":"<p>This is a completely new plugin architecture. Previous versions (0.6.0 and earlier as netbox-circuitmaintenance) are not compatible.</p>"},{"location":"changelog/#historical-releases-netbox-circuitmaintenance","title":"Historical Releases (netbox-circuitmaintenance)","text":""},{"location":"changelog/#060-2025-09-08","title":"0.6.0 (2025-09-08)","text":"<ul> <li>Netbox 4.4 support</li> <li>Bug fix by @PetrVoronov</li> <li>Highlight current date in calendar event view</li> </ul>"},{"location":"changelog/#050-2025-06-02","title":"0.5.0 (2025-06-02)","text":"<ul> <li>Netbox 4.2 support</li> </ul>"},{"location":"changelog/#042-2024-09-29","title":"0.4.2 (2024-09-29)","text":"<ul> <li>Adding Maintenance calendar widget</li> <li>Fix #26 - f string quote issue with NB 4.1</li> </ul>"},{"location":"changelog/#041-2024-09-19","title":"0.4.1 (2024-09-19)","text":"<ul> <li>Adding Maintenance Schedule calendar</li> </ul>"},{"location":"changelog/#040-2024-09-19","title":"0.4.0 (2024-09-19)","text":"<ul> <li>Adds support for Netbox 4.0 and 4.1</li> <li>Adds widget to show circuit maintenance events</li> <li>Updates styling to match new Netbox style</li> </ul>"},{"location":"changelog/#030-2023-04-28","title":"0.3.0 (2023-04-28)","text":"<ul> <li>Fixed support for Netbox 3.5. NOTE: Plugin version 0.3.0+ is only compatible with Netbox 3.5+</li> </ul>"},{"location":"changelog/#022-2023-01-18","title":"0.2.2 (2023-01-18)","text":"<ul> <li>Fix API Filtersets</li> <li>Viewing notification content opens a new tab</li> <li>Updating RESCHEDULED to RE-SCHEDULED to match circuitparser</li> </ul>"},{"location":"changelog/#021-2023-01-17","title":"0.2.1 (2023-01-17)","text":"<ul> <li>Updating to DynamicModelChoiceField</li> <li>Hiding maintenance schedule for now</li> </ul>"},{"location":"changelog/#010-2023-01-15","title":"0.1.0 (2023-01-15)","text":"<ul> <li>First release on PyPI.</li> </ul>"},{"location":"contributing/","title":"Contributing","text":""},{"location":"contributing/#contributing","title":"Contributing","text":"<p>Contributions are welcome, and they are greatly appreciated! Every little bit helps, and credit will always be given.</p> <p>You can contribute in many ways:</p>"},{"location":"contributing/#types-of-contributions","title":"Types of Contributions","text":""},{"location":"contributing/#report-bugs","title":"Report Bugs","text":"<p>Report bugs at https://github.com/jsenecal/netbox-notices/issues.</p> <p>If you are reporting a bug, please include:</p> <ul> <li>Your operating system name and version.</li> <li>Any details about your local setup that might be helpful in troubleshooting.</li> <li>Detailed steps to reproduce the bug.</li> </ul>"},{"location":"contributing/#fix-bugs","title":"Fix Bugs","text":"<p>Look through the GitHub issues for bugs. Anything tagged with \"bug\" and \"help wanted\" is open to whoever wants to implement it.</p>"},{"location":"contributing/#implement-features","title":"Implement Features","text":"<p>Look through the GitHub issues for features. Anything tagged with \"enhancement\" and \"help wanted\" is open to whoever wants to implement it.</p>"},{"location":"contributing/#write-documentation","title":"Write Documentation","text":"<p>NetBox Vendor Notification Plugin could always use more documentation, whether as part of the official NetBox Vendor Notification Plugin docs, in docstrings, or even on the web in blog posts, articles, and such.</p>"},{"location":"contributing/#submit-feedback","title":"Submit Feedback","text":"<p>The best way to send feedback is to file an issue at https://github.com/jsenecal/netbox-notices/issues.</p> <p>If you are proposing a feature:</p> <ul> <li>Explain in detail how it would work.</li> <li>Keep the scope as narrow as possible, to make it easier to implement.</li> <li>Remember that contributions are welcome :)</li> </ul>"},{"location":"contributing/#get-started","title":"Get Started!","text":"<p>Ready to contribute? Here's how to set up <code>netbox-notices</code> for local development.</p> <ol> <li>Fork the <code>netbox-notices</code> repo on GitHub.</li> <li> <p>Clone your fork locally</p> <pre><code>$ git clone git@github.com:your_name_here/netbox-notices.git\n</code></pre> </li> <li> <p>Install dependencies and start your virtualenv:</p> <pre><code>$ python3 -m venv venv\n$ source venv/bin/activate\n$ pip install -e \".[dev]\"\n</code></pre> </li> <li> <p>Create a branch for local development:</p> <pre><code>$ git checkout -b name-of-your-bugfix-or-feature\n</code></pre> <p>Now you can make your changes locally.</p> </li> <li> <p>When you're done making changes, check that your changes pass the    tests and linting:</p> <pre><code>$ ./venv/bin/pytest tests/ -v\n$ ./venv/bin/ruff format notices/ tests/\n$ ./venv/bin/ruff check --fix notices/ tests/\n</code></pre> </li> <li> <p>Commit your changes and push your branch to GitHub:</p> <pre><code>$ git add .\n$ git commit -m \"Your detailed description of your changes.\"\n$ git push origin name-of-your-bugfix-or-feature\n</code></pre> </li> <li> <p>Submit a pull request through the GitHub website.</p> </li> </ol>"},{"location":"contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<p>Before you submit a pull request, check that it meets these guidelines:</p> <ol> <li>The pull request should include tests.</li> <li>If the pull request adds functionality, the docs should be updated. Put    your new functionality into a function with a docstring, and add the    feature to the list in README.md.</li> <li>The pull request should work for Python 3.10, 3.11, and 3.12. Check    https://github.com/jsenecal/netbox-notices/actions    and make sure that the tests pass for all supported Python versions.</li> </ol>"},{"location":"contributing/#deploying","title":"Deploying","text":"<p>A reminder for the maintainers on how to deploy. Make sure all your changes are committed (including an entry in CHANGELOG.md). Then run:</p> <pre><code>$ pip install bumpver build twine\n$ bumpver update --patch  # or --minor, --major\n$ python -m build\n$ twine upload dist/*\n</code></pre>"},{"location":"parsers/","title":"Using a parser","text":"<p>Parsers are designed to take the incoming email notifications from carriers and parse them in to a machine readable JSON format which can then be passed to the circuit maintenance plugin API for storage and further processing. The challenge is that virtually every provider leverages their own maintenance notification format with very little uptake of industry standards, the circuit-maintenance-parser python package was written to convert both standard based iCal notifications and non-standard HTML based notifications in to a well defined structure.</p> <p>The high level process is simple, a parser leverages the  circuit-maintenance-parser library to parse inbound notifications, passing them to the NetBox Circuit Maintenance plugin, the plugin then stores and optionally post-processes the notification (i.e. duplication detection, consolidated notifications).</p> <p>The following parsers have been written and/or contributed by the community to assist in automating provider maintenance notifications:</p> <ul> <li> <p>AWS SNS &amp; Lambda</p> </li> <li> <p>IMAP Netbox Script (Coming Soon)</p> </li> <li> <p>IMAP CRON Job (Coming Soon)</p> </li> </ul>"},{"location":"parsers_sns_lambda/","title":"AWS SNS & Lambda","text":"<p>This parser leverages a server-less design for near-realtime processing of provider notifications via AWS Simple Email Service, S3 &amp; Lambda to receive, parse and push maintenance events to NetBox. </p> <p>Pricing for the deployment will vary based on the volume of emails processed per month however in testing it is feasible to operate this solution for under $1/mo with less than 1000 emails/mo.</p>"},{"location":"parsers_sns_lambda/#requirements","title":"Requirements","text":"<p>Amazon AWS Simple Email Service Amazon AWS Lambda Amazon AWS S3 Connectivity from your VPC hosting the Lambda function to Netbox.</p> <p>Note: The basic setup of verifying your domain and publishing MX records to allow SES to receive email on behalf of your domain is not covered in this guide, please see Setting up Amazon SES email receiving.</p> <p>Note: Your Lambda function either needs to be in the same VPC as Netbox, have connectivity to Netbox over the internet, or have private connectivity to Netbox via Direct Connect etc.</p> <p>Note: You will need to inform any relevant circuit providers to send maintenance notifications to the email address you configure to be processed by SES. This guide does not cover that process.</p>"},{"location":"parsers_sns_lambda/#flow-diagram","title":"Flow Diagram","text":"<ol> <li>Provider sends email notification to email address configured for receiving email in AWS SES</li> <li>SES stores the raw email as S3 object</li> <li>SES triggers Lambda function and passes email headers</li> <li>Lambda function retrieves raw email from S3, performs validation of the provider and parses it using circuit_maintenance_parser</li> <li>Maintenance event is passed to NetBox for storage and further processing </li> </ol>"},{"location":"parsers_sns_lambda/#aws-setup","title":"AWS Setup","text":"<p>The following steps will guide you through creating a Lambda function, giving it permission to read from an S3 bucket along with VPC access (if required), creating the SES rules to pass emails to Lambda and the creation of an S3 bucket to store incoming email.</p> <p>Step 1 - Navigate to Lambda -&gt; Create Function to create a new Lambda function to host the email parser. 1. Enter a name for the Lambda function &amp; select Python 3.9 as the runtime.  2. Under Advanced Settings, enable VPC access. (If required) 3. Select the VPC, 2 or more relevant subnets from your VPC and an appropriate security group. 4. Click Create function 5. Once created, navigate to Configuration -&gt; Permissions to find the IAM role that was automatically created. Click the role name to launch the IAM tool. 6. Navigate to Add Permissions -&gt; Attach Policies and select AmazonS3ReadOnlyAccess and click Attach Policy </p> <p>Step 2 - Navigate to Simple Email Service -&gt; Email receiving and create a rule set.</p> <p></p> <ol> <li>Within the rule set you just created, create a new rule.</li> <li>Enter a name for the rule, ensure it is Enabled. Leave security options as default.</li> <li>Add new recipient condition - enter the email address you wish to use to receive email. You must have previously verified your domain with SES and setup MX records.</li> <li>Add new action -&gt; Deliver to S3 bucket. You can specify an existing bucket or have SES create a new one for you.</li> <li>Add new action -&gt; Invoke AWS Lambda function. Select the Lambda function you created in Step 1. Ensure invocation type is set to Event Invocation which will trigger the Lambda function as each email is received. </li> <li>Click Next followed by Create Rule. Allow AWS to create the relevant IAM permissions for SES to access the Lambda function.</li> </ol> <p>Step 3 - Update S3 bucket to disable public access (if required)</p> <p>If you allowed SES to create the S3 bucket automatically, it creates the bucket with public access enabled, this is not recommended or required for this deployment and should be disabled.</p> <ol> <li>Navigate to S3 -&gt; Select your bucket that was created.</li> <li>Click Permissions and under Block Public Access select Edit. </li> <li>Select Block all public access &amp; Save Changes </li> </ol>"},{"location":"parsers_sns_lambda/#lambda-deployment","title":"Lambda Deployment","text":"<p>Due to how Lambda operates in an ephemeral environment, there is no means to install packages from pip on each invocation of the Lambda function, as a result you have to build the Lambda function locally and create a zip file containing the function and all required python modules. The following steps will guide you through configuring the python script for your environment, building the package and uploading it to the Lambda function.</p> <p>If you haven't already, use git to checkout a copy of the netbox-circuitmaintenance git repository. </p> <p>Step 1 - Configure variables</p> <ol> <li>Navigate to <code>parsers/aws-sns-lambda/</code></li> <li>Edit lambda_function.py and configure the following variables as relevant for your environment <pre><code>S3_BUCKET_NAME  =  'your-s3-bucket'\nNB_URL  =  'https://netbox.yourdomain.com'\nNB_API_TOKEN  =  'yournetboxtokenhere'\nS3_DELETE_UNKNOWN  =  False # Delete non-provider matched emails from the S3 bucket\nS3_DELETE_PROCESSED  =  False # Delete provder matched emails from the S3 bucket after processing\n</code></pre></li> </ol> <p>Step 2 - Build lambda deployment package</p> <p>A bash script is included with the python code that creates a local virtual environment, collects the required python modules and creates a .zip file that can be uploaded to Lambda. To execute the bash script do the following</p> <ol> <li><code>chmod +x create_pkg.sh</code> </li> <li><code>./create_pkg.sh</code></li> </ol> <p>Example: <pre><code>Executing create_pkg.sh...\ncreated virtual environment CPython3.9.6.final.0-64 in 762ms\nInstalling dependencies...\nFrom: requirements.txt file exists...\n......\nRemoving virtual environment folder...\nFinished script execution!\n</code></pre></p> <p>After execution has finished, you will be left with a zip archive <code>lambda_package.zip</code> that can be uploaded to your AWS Lambda function.</p> <p>Step 3 - Upload the package to Lambda</p> <ol> <li>Navigate to Lambda -&gt; Your function - &gt; Code</li> <li>Under Upload From select .zip </li> <li>Upload the zip archive created</li> </ol>"},{"location":"parsers_sns_lambda/#troubleshooting","title":"Troubleshooting","text":"<p>Email's are not received by SES This guide does not cover the setup of SES and creation of MX records etc. Please refer to AWS troubleshooting guides for SES. If SES is setup correctly, each email sent to SES will create a new S3 object.</p> <p>Lambda is not processing emails received by SES If you are correctly receiving email and SES is storing them in S3, review the CloudWatch logs for your Lambda function to confirm that Lambda is correctly invoking your function each time an email is received. The cloudwatch logs will show any errors generated by the python script.</p> <p>Timeout in connection to Netbox Validate your Lambda function has connectivity to Netbox, if Netbox is hosted in AWS or within your network, the function must have VPC permissions enabled and must have network connectivity to Netbox. </p> <p>Building from an M1 Mac If you are using an M1 Mac to build the Lambda package, some dependencies compile a binary which will not work on an x86 based Lambda function. Either build the package on an x86 based machine or re-create the Lambda function and choose arm as the environment type.</p>"}]}